(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["subpkg/register/register"],{"3f47":function(e,t){},"3f56":function(e,t,n){"use strict";var r=n("dae9"),o=n.n(r);o.a},"4fda":function(e,t,n){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0}),t.requestVerificationCode=t.requestUserInfo=t.requestRegister=t.requestLogin=void 0;var n=e.$u.http;t.requestLogin=function(e){return n.post("/wx-api/login",e)};t.requestUserInfo=function(){return n.get("/wx-api/me/info")};t.requestVerificationCode=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return n.get("/wx-api/validcode",e)};t.requestRegister=function(e){return n.post("/wx-api/register",e)}}).call(this,n("543d")["default"])},"5c12":function(e,t,n){"use strict";(function(e,t){var r=n("4ea4");n("3f47");r(n("66fd"));var o=r(n("6b80"));e.__webpack_require_UNI_MP_PLUGIN__=n,t(o.default)}).call(this,n("bc2e")["default"],n("543d")["createPage"])},"6b80":function(e,t,n){"use strict";n.r(t);var r=n("9577"),o=n("bb55");for(var i in o)["default"].indexOf(i)<0&&function(e){n.d(t,e,(function(){return o[e]}))}(i);n("3f56");var s=n("f0c5"),a=Object(s["a"])(o["default"],r["b"],r["c"],!1,null,"365bbbfd",null,!1,r["a"],void 0);t["default"]=a.exports},9577:function(e,t,n){"use strict";n.d(t,"b",(function(){return r})),n.d(t,"c",(function(){return o})),n.d(t,"a",(function(){}));var r=function(){var e=this.$createElement;this._self._c},o=[]},"9bd2":function(e,t,n){"use strict";(function(e){var r=n("4ea4");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o=r(n("9523")),i=n("26cb"),s=n("4fda");function a(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function u(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?a(Object(n),!0).forEach((function(t){(0,o.default)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):a(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var c={name:"register",data:function(){return{phoneNumber:"",verificationCode:"",btnText:"获取验证码",disableBtn:!1,submitDisabled:!0,countdown:5,codeInputDisabled:!0,userInfo:{nickName:"",avatarUrl:"",gender:""}}},methods:u(u({},(0,i.mapMutations)("m_user",["updateUserInfo","updateToken"])),{},{handleInput:function(){/^1[0-9]{10}$/.test(this.phoneNumber)?this.disableBtn=!1:this.disableBtn=!0},sendVerificationCode:function(){var t=this;if(""==this.phoneNumber)e.$showMsg("请输入手机号"),this.disableBtn=!1;else{this.btnText="".concat(this.countdown,"s 后重新获取"),this.disableBtn=!0,this.codeInputDisabled=!1,this.submitDisabled=!1;var n=setInterval((function(){t.countdown<=1?(clearInterval(n),t.btnText="重新获取",t.countdown=5,t.disableBtn=!1,t.codeInputDisabled=!1):(t.countdown--,t.btnText="".concat(t.countdown,"s 后重新获取"))}),1e3);(0,s.requestVerificationCode)({params:{phone:this.phoneNumber}}).then((function(t){0==t.data.code&&e.$showMsg("验证码获取成功")}))}},handleSubmit:function(){var t=this;if(""==t.phoneNumber&&"666666"!==t.verificationCode)return e.$showMsg("请输入手机号和验证码"),!1;e.getUserProfile({desc:"用户信息",success:function(n){t.updateUserInfo(n.userInfo),t.userInfo=n.userInfo,e.login({provider:"weixin",success:function(n){var r=n.code,o={code:r,phone:t.phoneNumber,verifyCode:t.verificationCode,nickname:t.userInfo.nickName,avatarUrl:t.userInfo.avatarUrl,gender:t.userInfo.gender};(0,s.requestRegister)(o).then((function(n){console.log("res",n),0==n.data.code?(t.updateToken(n.data.data.token),e.$showMsg("注册成功"),e.switchTab({url:"/pages/my/my"})):e.$showMsg(n.data.message)})).catch((function(t){console.error(t),e.$showMsg("服务器出错，请稍后再试")}))}})}})}})};t.default=c}).call(this,n("543d")["default"])},bb55:function(e,t,n){"use strict";n.r(t);var r=n("9bd2"),o=n.n(r);for(var i in r)["default"].indexOf(i)<0&&function(e){n.d(t,e,(function(){return r[e]}))}(i);t["default"]=o.a},dae9:function(e,t,n){}},[["5c12","common/runtime","common/vendor"]]]);